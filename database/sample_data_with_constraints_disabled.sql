-- サンプルデータ挿入用SQL（外部キー制約を一時的に無効化）
-- このファイルを実行する前に、schema.sqlを実行してください

-- 外部キー制約を一時的に無効化
BEGIN;

-- トリガーを無効化
ALTER TABLE memos DISABLE TRIGGER ALL;
ALTER TABLE user_progress DISABLE TRIGGER ALL;
ALTER TABLE quiz_attempts DISABLE TRIGGER ALL;

-- Insert sample books
INSERT INTO books (title, author, description, category, tags, recommended_by) VALUES
('思考の整理学', '外山滋比古', '思考を整理し、創造的な発想を生み出すための方法論について学んだ。特に「思考の外化」の重要性を理解できた。', '思考法', ARRAY['思考法', '整理術', '創造性'], '田中太郎'),
('アウトプット大全', '樺沢紫苑', '学んだことを確実に身につけるためのアウトプット術について。特に「2週間に3回のアウトプット」の法則が印象的だった。', '学習法', ARRAY['学習法', 'アウトプット', '記憶'], '佐藤花子'),
('デジタル時代の読書術', '佐藤優', 'デジタル時代における効率的な読書方法と情報処理について解説。', '読書術', ARRAY['読書術', 'デジタル', '情報処理'], '山田次郎'),
('習慣の力', 'チャールズ・デュヒッグ', '習慣がどのように形成され、人生に影響を与えるかを科学的に解説。', '心理学', ARRAY['習慣', '心理学', '行動科学'], '鈴木一郎'),
('深い学び', '安西祐一郎', '深い理解を促進する学習理論と認知科学の最新研究を紹介。', '教育', ARRAY['学習理論', '認知科学', '教育'], '高橋美咲'),
('クリエイティブ思考', 'マイケル・ミカルコ', '創造性を高めるための思考法とイノベーション手法を解説。', '創造性', ARRAY['創造性', 'イノベーション', '発想法'], '伊藤健太'),
('時間管理術', 'デビッド・アレン', 'GTD（Getting Things Done）手法による効率的な時間管理術。', '生産性', ARRAY['時間管理', '生産性', '効率化'], '渡辺さくら'),
('集中力の科学', 'ダニエル・ゴールマン', '集中力を高めるための脳科学とメンタルトレーニング。', '脳科学', ARRAY['集中力', '脳科学', 'パフォーマンス'], '中村大輔'),
('記憶術大全', 'ドミニク・オブライエン', '記憶力を向上させるための様々なテクニックと訓練法。', '記憶術', ARRAY['記憶術', '暗記法', '学習効率'], '小林あい'),
('学習の技法', '竹内洋', '効果的な学習方法とスキルアップのための実践的ガイド。', '学習法', ARRAY['学習法', 'スキルアップ', '自己啓発'], '加藤雄一');

-- Insert sample bookstores
INSERT INTO bookstores (name, address, description, tags, latitude, longitude) VALUES
('蔦屋書店 代官山店', '東京都渋谷区代官山町17-5', '世界で最も美しい書店の一つ。建築と本が融合した空間で、新しい読書体験を提供します。', ARRAY['建築', 'カフェ', 'アート'], 35.6581, 139.7034),
('神保町古書センター', '東京都千代田区神田神保町1-21', '古書の聖地として知られる老舗書店。貴重な古書から最新刊まで幅広く取り揃えています。', ARRAY['古書', '歴史', '専門書'], 35.6956, 139.7578),
('本屋B&B', '東京都世田谷区下北沢2-12-4', '本とビールが楽しめるユニークな書店。読書会やイベントも頻繁に開催されています。', ARRAY['イベント', 'ビール', 'コミュニティ'], 35.6617, 139.6668),
('森岡書店', '東京都中央区銀座1-28-15', '1週間に1冊だけを売る革新的な書店。店主の厳選された一冊との出会いが待っています。', ARRAY['厳選', '店主推薦', '限定'], 35.6719, 139.7659),
('ブックファースト 新宿店', '東京都新宿区新宿3-26-13', '新宿の中心地にある大型書店。最新のベストセラーから専門書まで豊富な品揃えです。', ARRAY['大型', 'ベストセラー', 'アクセス良好'], 35.6909, 139.7003),
('三省堂書店 神保町本店', '東京都千代田区神田神保町1-1', '神保町の老舗書店。学術書や専門書の品揃えが充実しており、研究者にも愛されています。', ARRAY['学術書', '専門書', '老舗'], 35.6956, 139.7578),
('代官山 蔦屋書店', '東京都渋谷区猿楽町17-5', '代官山のランドマーク的存在。本、音楽、映画が融合した複合文化施設です。', ARRAY['複合施設', '音楽', '映画'], 35.6581, 139.7034),
('丸善 丸の内本店', '東京都千代田区丸の内1-6-4', '丸の内のビジネス街にある老舗書店。ビジネス書や実用書の品揃えが特に充実しています。', ARRAY['ビジネス書', '実用書', 'ビジネス街'], 35.6812, 139.7671),
('ジュンク堂書店 池袋本店', '東京都豊島区南池袋1-28-2', '池袋の大型書店。文芸書から実用書まで幅広いジャンルをカバーしています。', ARRAY['文芸書', '実用書', '大型'], 35.7295, 139.7109),
('有隣堂 横浜店', '神奈川県横浜市西区南幸1-5-1', '横浜の老舗書店。地域に根ざした書店として、地元の人々に愛され続けています。', ARRAY['地域密着', '老舗', '横浜'], 35.4658, 139.6204);

-- Insert sample memos (プレースホルダーのユーザーIDを使用)
INSERT INTO memos (book_id, user_id, content, is_public, page_number, chapter, tags) 
SELECT 
  b.id,
  '00000000-0000-0000-0000-000000000001'::uuid, -- Placeholder user ID
  '思考の外化について学んだ。思考を紙に書き出すことで、より明確になり、新しいアイデアが生まれやすくなる。',
  true,
  45,
  '第3章 思考の外化',
  ARRAY['思考法', '外化', 'アイデア']
FROM books b WHERE b.title = '思考の整理学';

INSERT INTO memos (book_id, user_id, content, is_public, page_number, chapter, tags) 
SELECT 
  b.id,
  '00000000-0000-0000-0000-000000000001'::uuid,
  '2週間に3回のアウトプットの法則が印象的だった。学習した内容を確実に定着させるには、定期的なアウトプットが重要。',
  false,
  78,
  '第4章 アウトプットの法則',
  ARRAY['アウトプット', '定着', '学習']
FROM books b WHERE b.title = 'アウトプット大全';

-- Insert sample quizzes
INSERT INTO quizzes (book_id, question, options, correct_answer, explanation, difficulty)
SELECT 
  b.id,
  '思考の外化とは何ですか？',
  ARRAY['思考を他人に伝えること', '思考を紙に書き出すこと', '思考を整理すること', '思考を忘れること'],
  1,
  '思考の外化とは、頭の中の思考を紙やデジタル媒体に書き出すことを指します。これにより思考が明確になり、新しいアイデアが生まれやすくなります。',
  'medium'
FROM books b WHERE b.title = '思考の整理学';

INSERT INTO quizzes (book_id, question, options, correct_answer, explanation, difficulty)
SELECT 
  b.id,
  'アウトプットの効果的な頻度はどのくらいですか？',
  ARRAY['毎日', '2週間に3回', '月に1回', '必要に応じて'],
  1,
  '樺沢紫苑氏によると、学習した内容を確実に定着させるには「2週間に3回のアウトプット」が効果的とされています。',
  'easy'
FROM books b WHERE b.title = 'アウトプット大全';

-- トリガーを再有効化
ALTER TABLE memos ENABLE TRIGGER ALL;
ALTER TABLE user_progress ENABLE TRIGGER ALL;
ALTER TABLE quiz_attempts ENABLE TRIGGER ALL;

COMMIT;
